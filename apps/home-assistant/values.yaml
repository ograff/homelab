home-assistant:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: power
            operator: In
            values:
            - high
  ingress:
    main:
      enabled: true
      ingressClassName: nginx
      annotations:
        nginx.org/websocket-services: home-assistant
        cert-manager.io/cluster-issuer: letsencrypt-prod
        external-dns.alpha.kubernetes.io/target: "homelab-tunnel.2411.house"
        external-dns.alpha.kubernetes.io/cloudflare-proxied: "true"
        hajimari.io/appName: Home Assistant
        hajimari.io/icon: home-assistant
      hosts:
        - host: &host home-assistant.2411.house
          paths:
            - path: /
              pathType: Prefix
      tls:
        - secretName: home-assistant-tls-certificate
          hosts:
            - *host
  persistence:
    config:
      enabled: true 
      size: 8Gi

  dnsConfig:
    options:
      - name: ndots
        value: "1"
  image:
    repository: ghcr.io/home-assistant/home-assistant
    tag: 2022.10.5
  addons:
    codeserver:
      enabled: true

  # -- Enable devices to be discoverable
  hostNetwork: true

  # -- When hostNetwork is true set dnsPolicy to ClusterFirstWithHostNet
  dnsPolicy: ClusterFirstWithHostNet
